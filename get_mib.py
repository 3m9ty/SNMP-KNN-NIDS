import sys
import os
import time

print("===================================")
x = int(input("Please select the data type number: \n"+" (0)NORMAL (1)ARP (2)ICMP (3)TCP (4)UDP \n"+"Data type: "))
y = int(input("\nSelect the numbers of file: "))
z = int(input("\nSelect the amount of file : "))

switch_oid = ['1.3.6.1.2.1.2.2.1.10.2','1.3.6.1.2.1.2.2.1.10.24','1.3.6.1.2.1.2.2.1.11.2','1.3.6.1.2.1.2.2.1.11.24',
              '1.3.6.1.2.1.2.2.1.16.2','1.3.6.1.2.1.2.2.1.16.24','1.3.6.1.2.1.2.2.1.17.2','1.3.6.1.2.1.2.2.1.17.24']

host_oid = ['1.3.6.1.2.1.4.3.0','1.3.6.1.2.1.4.9.0','1.3.6.1.2.1.4.10.0','1.3.6.1.2.1.4.11.0','1.3.6.1.2.1.4.31.1.1.3.1',
            '1.3.6.1.2.1.4.31.1.1.5.1','1.3.6.1.2.1.4.31.1.1.18.1','1.3.6.1.2.1.4.31.1.1.20.1','1.3.6.1.2.1.4.31.1.1.25.1',
            '1.3.6.1.2.1.4.31.1.1.30.1','1.3.6.1.2.1.4.31.1.1.32.1','1.3.6.1.2.1.5.1.0','1.3.6.1.2.1.5.3.0','1.3.6.1.2.1.5.9.0',
						'1.3.6.1.2.1.5.14.0','1.3.6.1.2.1.5.15.0','1.3.6.1.2.1.5.16.0','1.3.6.1.2.1.5.22.0','1.3.6.1.2.1.5.29.1.2.1',
						'1.3.6.1.2.1.5.29.1.4.1','1.3.6.1.2.1.5.29.1.5.1','1.3.6.1.2.1.5.30.1.3.1.3','1.3.6.1.2.1.5.30.1.3.1.8','1.3.6.1.2.1.5.30.1.4.1.0',
						'1.3.6.1.2.1.5.30.1.4.1.3','1.3.6.1.2.1.6.10.0','1.3.6.1.2.1.6.11.0','1.3.6.1.2.1.6.12.0','1.3.6.1.2.1.6.15.0','1.3.6.1.2.1.7.2.0']



if x == 0:
	x = 'normal'
elif x == 1:
	x = 'arp'
elif x == 2:
	x = 'icmp'
elif x == 3:
	x = 'tcp'
elif x == 4:
	x = 'udp'  
else:
	print("The data type number is wrong!")
	os.exit()
 
for i in range(y,z+1):
  print("Start to Poll MiB (" + str(i) + "/" + str(z) + ")\n")
	
  #Capture OID from Switch(192.168.1.253)
  for j in switch_oid:			 
	  os.system("snmpwalk -v 2c -c public 192.168.1.253 " + j + " >>" + " ~/SNMP/MIB/" + x + str(i))
  
  #Capture OID from attacked host(192.168.1.100)
  for k in host_oid:		
	  os.system("snmpwalk -v 2c -c public 192.168.1.100 " + k + " >>" + " ~/SNMP/MIB/" + x + str(i))
  
  time.sleep(20)	  	  

print("Finished\n")
